{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-05427f93\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"user-profile\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"profile-title\"\n}, \"Edit My Avatar\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0,\n  class: \"profile-content\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  class: \"btn-box\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Header = _resolveComponent(\"Header\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_Header, {\n    handleCollapse: $data.handleCollapse,\n    isCollapse: $data.isCollapse\n  }, null, 8 /* PROPS */, [\"handleCollapse\", \"isCollapse\"]), _createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _ctx.userInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n    src: _ctx.file || $options.gravatarUrl,\n    alt: \"用户头像\",\n    class: \"user-avatar\"\n  }, null, 8 /* PROPS */, _hoisted_4)])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_button, {\n    type: \"primary\",\n    class: \"chooseAvg\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"input\", {\n      type: \"file\",\n      name: \"file\",\n      accept: \".jpg,.png,.gif,.bmp\",\n      id: \"file\",\n      onChange: _cache[0] || (_cache[0] = (...args) => $options.choose && $options.choose(...args))\n    }, null, 32 /* HYDRATE_EVENTS */), _createTextVNode(\" Choose Avatar \")]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: $options.uploadImg\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"Confirm Avatar\")]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","_createVNode","_component_Header","handleCollapse","$data","isCollapse","_hoisted_1","_hoisted_2","_ctx","userInfo","_createElementBlock","_hoisted_3","src","file","$options","gravatarUrl","alt","_hoisted_5","_component_el_button","type","name","accept","id","onChange","_cache","args","choose","onClick","uploadImg"],"sources":["/Users/wucongzhen/Documents/GitHub/Akarana/src/src/views/Avatar.vue"],"sourcesContent":["<template>\n  <Header :handleCollapse=\"handleCollapse\" :isCollapse=\"isCollapse\"> </Header>\n\n  <div class=\"user-profile\">\n    <h2 class=\"profile-title\">Edit My Avatar</h2>\n    <div v-if=\"userInfo\" class=\"profile-content\">\n      <img :src=\"file || gravatarUrl\" alt=\"用户头像\" class=\"user-avatar\" />\n    </div>\n    <div class=\"btn-box\">\n      <el-button type=\"primary\" class=\"chooseAvg\">\n        <input\n          type=\"file\"\n          name=\"file\"\n          accept=\".jpg,.png,.gif,.bmp\"\n          id=\"file\"\n          @change=\"choose\"\n        />\n        Choose Avatar\n      </el-button>\n      <el-button type=\"primary\" @click=\"uploadImg\">Confirm Avatar</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport store from \"../store/index\";\nimport { mapState } from \"vuex\";\nimport http from \"@/utils/request\";\nimport { ElMessage } from \"element-plus\";\n\nexport default {\n  data() {\n    return {\n      isCollapse: false,\n      handleCollapse: null,\n      avg: \"\",\n    };\n  },\n  computed: {\n    ...mapState({\n      userInfo: (state) => state.userInfo,\n    }),\n    gravatarUrl() {\n      if (this.userInfo && this.userInfo.emailAddress) {\n        return this.userInfo.avatar === null\n          ? \"http://akarana.oss-ap-southeast-1.aliyuncs.com/car1.jpg\"\n          : this.userInfo.avatar;\n      }\n      return \"\";\n    },\n  },\n  methods: {\n    choose(event) {\n      let e = window.event || event;\n      if (e.target.files[0].size > 5 * 1024 * 1024) {\n      } else {\n        let file = e.target.files[0];\n\n        const formdate = new FormData();\n        formdate.append(\"avatar\", file);\n        this.formdate = formdate;\n        let reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = (result) => {\n          this.file = result.target.result;\n        };\n      }\n      \n      // 添加选择完成提示\n      ElMessage({\n        message: \"Choose Complete\",\n        type: \"success\",\n      });\n    },\n    async uploadImg() {\n      const { data } = await http.post(\n        `/api/avatar/${this.userInfo.username}`,\n        this.formdate,\n        { headers: { \"Content-Type\": \"multipart/form-data\" } }\n      );\n      console.log(data);\n      localStorage.removeItem(\"userInfo\");\n      store.dispatch({\n        type: \"getUserInfo\",\n        payload: this.userInfo.id,\n      });\n      \n      // 添加上传成功提示\n      ElMessage({\n        message: \"Confirmed\",\n        type: \"success\",\n      });\n    },\n  },\n};\n\n</script>\n\n<style scoped>\n.chooseAvg {\n  position: relative;\n}\n/* <!-- 将头像放大 --> */\n.user-avatar {\n  width: 300px; /* 设置头像宽度 */\n  height: 300px; /* 设置头像高度 */\n  object-fit: cover; /* 设置图片的尺寸和容器尺寸不一致时如何适应容器 */\n  border-radius: 50%; /* 设置圆角 */\n  margin: 20px auto; /* 居中显示 */\n  display: block; /* 转为块级元素，使 margin:auto 居中生效 */\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 添加阴影效果 */\n}\n#file {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  opacity: 0;\n  z-index: 10;\n}\n.user-profile {\n  width: 80%;\n  margin: 0 auto;\n  padding: 20px;\n  background-color: #f5f5f5;\n  border-radius: 5px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  height: 100%;\n}\n\n.profile-title {\n  text-align: center; /* 居中对齐 */\n  font-size: 48px; /* 设置字体大小 */\n  font-weight: bold; /* 设置粗体 */\n  margin-bottom: 20px; /* 底部留白 */\n  color: #333; /* 字体颜色 */\n  padding: 20px; /* 内边距 */\n}\n\n.profile-content {\n  padding: 20px;\n}\n\n.profile-content p {\n  font-size: 18px;\n  margin-bottom: 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.profile-content span {\n  color: #333;\n}\n\n.profile-content input {\n  flex-grow: 1;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  padding: 6px 12px;\n  font-size: 14px;\n  margin-left: 8px;\n}\n\nbutton {\n  background-color: #ff8936;\n  border: none;\n  color: white;\n  text-align: center;\n  display: inline-block;\n  font-size: 16px;\n  transition-duration: 0.4s;\n  cursor: pointer;\n  padding: 8px 16px;\n  border-radius: 4px;\n  margin: 20px;\n}\n\nbutton:hover {\n  background-color: #45a049;\n}\n\n.editbut {\n  background-color: #1e90ff;\n}\n\n.editbut:hover {\n  background-color: #187bcd;\n}\n\n.profile-content input.error {\n  border-color: red;\n}\ninput.error {\n  border-color: red;\n  color: red;\n}\n.error,\n.profile-content span[data-v-ced23842].error {\n  color: red;\n}\n\n/* 居中选择头像和上传头像按钮 */\n.chooseAvg {\n  position: relative; /* 设置为相对定位 */\n  display: flex; /* 弹性盒子 */\n  justify-content: center; /* 水平居中 */\n  align-items: center; /* 垂直居中 */\n}\n\n.btn-box {\n  display: flex; /* 弹性盒子 */\n  justify-content: center; /* 水平居中 */\n  margin-top: 20px; /* 设置上边距 */\n}\n\n/* 将按钮放大 */\n.el-button {\n  font-size: 16px;\n  padding: 28px 96px;\n}\n\n.el-button {\n  display: inline-flex !important;\n  align-items: center;\n  justify-content: center;\n}\n</style>\n"],"mappings":";;;EAGOA,KAAK,EAAC;AAAc;gEACvBC,mBAAA,CAA6C;EAAzCD,KAAK,EAAC;AAAe,GAAC,gBAAc;;;EACnBA,KAAK,EAAC;;;;EAGtBA,KAAK,EAAC;AAAS;;;;6DAPtBE,YAAA,CAA4EC,iBAAA;IAAnEC,cAAc,EAAEC,KAAA,CAAAD,cAAc;IAAGE,UAAU,EAAED,KAAA,CAAAC;6DAEtDL,mBAAA,CAkBM,OAlBNM,UAkBM,GAjBJC,UAA6C,EAClCC,IAAA,CAAAC,QAAQ,I,cAAnBC,mBAAA,CAEM,OAFNC,UAEM,GADJX,mBAAA,CAAiE;IAA3DY,GAAG,EAAEJ,IAAA,CAAAK,IAAI,IAAIC,QAAA,CAAAC,WAAW;IAAEC,GAAG,EAAC,MAAM;IAACjB,KAAK,EAAC;8EAEnDC,mBAAA,CAYM,OAZNiB,UAYM,GAXJhB,YAAA,CASYiB,oBAAA;IATDC,IAAI,EAAC,SAAS;IAACpB,KAAK,EAAC;;sBAC9B,MAME,CANFC,mBAAA,CAME;MALAmB,IAAI,EAAC,MAAM;MACXC,IAAI,EAAC,MAAM;MACXC,MAAM,EAAC,qBAAqB;MAC5BC,EAAE,EAAC,MAAM;MACRC,QAAM,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEX,QAAA,CAAAY,MAAA,IAAAZ,QAAA,CAAAY,MAAA,IAAAD,IAAA,CAAM;wDACf,iBAEJ,E;;MACAxB,YAAA,CAAuEiB,oBAAA;IAA5DC,IAAI,EAAC,SAAS;IAAEQ,OAAK,EAAEb,QAAA,CAAAc;;sBAAW,MAAc,C,iBAAd,gBAAc,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}