{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport store from '../store/index';\nimport http from '@/utils/request';\nimport router from \"../router/index\";\nimport axios from 'axios';\nimport { reactive, ref } from \"vue\";\nimport { onMounted, onUnmounted } from \"vue\";\nexport default {\n  __name: 'Login',\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const openPdf = () => {\n      const pdfPath = process.env.BASE_URL + 'applicationform.pdf';\n      window.open(pdfPath, '_blank');\n    };\n\n    // 初始的ref\n    const ref_form = ref(null);\n    // 表单的数据声明\n    const userInfo = reactive({\n      userName: \"\",\n      password: \"\"\n    });\n\n    // 表单数据校验规则\n    const rules = {\n      userName: [{\n        required: \"true\",\n        trigger: \"blur\",\n        message: \"Please input user name\"\n      }],\n      password: [{\n        required: \"true\",\n        trigger: \"blur\",\n        message: \"Please input password\"\n      }]\n    };\n    // 登录的方法\n    console.log(\"1\");\n    const onLogin = () => {\n      console.log(\"2\");\n      ref_form.value.validate(val => {\n        if (val) {\n          getLoginData();\n        }\n      });\n    };\n    // 获取登录数据\n    const getLoginData = async () => {\n      console.log(\"3\");\n      const {\n        data: {\n          status,\n          msg,\n          token,\n          userInfo: myuserInfo\n        }\n      } = await http.post('/api/login/', {\n        username: userInfo.userName,\n        password: userInfo.password\n      });\n      console.log(\"4\");\n      if (status === 1) {\n        console.log(\"5\");\n        ElMessage({\n          message: `${msg}`,\n          type: \"errr\"\n        });\n        return;\n      }\n      if (status === 0) {\n        console.log(\"6\");\n        ElMessage({\n          message: \"Welcome back, \" + userInfo.userName,\n          type: \"success\"\n        });\n        // localStorage.setItem('userId',myuserInfo.id);  \n        store.dispatch({\n          type: 'getUserInfo',\n          payload: myuserInfo.id\n        });\n        localStorage.setItem('@#@TOKEN', token);\n        router.push(\"/home\");\n      }\n    };\n    let bgMoveHandler;\n    onMounted(() => {\n      bgMoveHandler = e => {\n        const x = e.clientX / window.innerWidth;\n        const y = e.clientY / window.innerHeight;\n        const xOffset = -(x * 20);\n        const yOffset = -(y * 20);\n        const login = document.querySelector(\".login\");\n        login.style.backgroundPosition = `calc(50% + ${xOffset}px) calc(50% + ${yOffset}px)`;\n      };\n      document.addEventListener(\"mousemove\", bgMoveHandler);\n    });\n    onUnmounted(() => {\n      document.removeEventListener(\"mousemove\", bgMoveHandler);\n    });\n    const __returned__ = {\n      openPdf,\n      ref_form,\n      userInfo,\n      rules,\n      onLogin,\n      getLoginData,\n      get bgMoveHandler() {\n        return bgMoveHandler;\n      },\n      set bgMoveHandler(v) {\n        bgMoveHandler = v;\n      },\n      get store() {\n        return store;\n      },\n      get http() {\n        return http;\n      },\n      get router() {\n        return router;\n      },\n      get axios() {\n        return axios;\n      },\n      reactive,\n      ref,\n      onMounted,\n      onUnmounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["store","http","router","axios","reactive","ref","onMounted","onUnmounted","openPdf","pdfPath","process","env","BASE_URL","window","open","ref_form","userInfo","userName","password","rules","required","trigger","message","console","log","onLogin","value","validate","val","getLoginData","data","status","msg","token","myuserInfo","post","username","ElMessage","type","dispatch","payload","id","localStorage","setItem","push","bgMoveHandler","e","x","clientX","innerWidth","y","clientY","innerHeight","xOffset","yOffset","login","document","querySelector","style","backgroundPosition","addEventListener","removeEventListener"],"sources":["/Users/wucongzhen/Documents/GitHub/Akarana/src/src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login\">\n    <div class=\"bgp\"></div>\n    <div class=\"login_container\">\n      <h1>MemberOnly</h1>\n      <el-form class=\"login_form\" :model=\"userInfo\" :rules=\"rules\" @keyup.enter=\"onLogin\" ref=\"ref_form\">\n        <el-form-item prop=\"userName\">\n          <el-input placeholder=\"username\" v-model.trim=\"userInfo.userName\">\n            <template #prepend>\n              <el-icon>\n                <avatar />\n              </el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n\n        <el-form-item prop=\"password\">\n          <el-input placeholder=\"passowrd\" show-password v-model.trim=\"userInfo.password\">\n            <template #prepend>\n              <el-icon>\n                <key />\n              </el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n        <el-button type=\"primary\" class=\"login_submit\" @click=\"onLogin\">Login</el-button>\n        <div class=\"login_register\" @click=\"openPdf\">Register form</div>\n        <!-- <div class=\"test\"></div> -->\n      </el-form>\n    </div>\n  </div>\n</template>\n\n\n<script setup>\nimport store from '../store/index'\nimport http from '@/utils/request'\nimport router from \"../router/index\";\nimport axios from 'axios'\nimport { reactive, ref } from \"vue\";\nimport { onMounted, onUnmounted } from \"vue\";\nconst openPdf = () => {\n  const pdfPath = process.env.BASE_URL + 'applicationform.pdf';\n  window.open(pdfPath, '_blank');\n};\n\n\n// 初始的ref\nconst ref_form = ref(null);\n// 表单的数据声明\nconst userInfo = reactive({\n  userName: \"\",\n  password: \"\",\n});\n\n// 表单数据校验规则\nconst rules = {\n  userName: [\n    { required: \"true\", trigger: \"blur\", message: \"Please input user name\" },\n  ],\n  password: [\n    { required: \"true\", trigger: \"blur\", message: \"Please input password\" },\n  ],\n};\n// 登录的方法\nconsole.log(\"1\");\nconst onLogin = () => {\n  console.log(\"2\");\n  \n  ref_form.value.validate((val) => {\n    if (val) {\n      getLoginData();\n    }\n  });\n};\n// 获取登录数据\nconst getLoginData = async () => {\n  console.log(\"3\");\n\n  const { data: { status, msg, token ,userInfo:myuserInfo} } = await http.post('/api/login/', {\n    \n    username: userInfo.userName,\n    password: userInfo.password\n  });\n  console.log(\"4\");\n  if (status === 1) {\n    console.log(\"5\");\n    ElMessage({\n      message: `${msg}`,\n      type: \"errr\",\n    });\n    return;\n  }\n\n  if (status === 0) {\n    console.log(\"6\");\n    ElMessage({\n      message: \"Welcome back, \" + userInfo.userName,\n     \n      type: \"success\",\n    });\n    // localStorage.setItem('userId',myuserInfo.id);  \n    store.dispatch({\n      type:'getUserInfo',\n      payload:myuserInfo.id\n    })\n    localStorage.setItem('@#@TOKEN', token)\n    router.push(\"/home\");\n  }\n\n};\n\nlet bgMoveHandler;\n\nonMounted(() => {\n  bgMoveHandler = (e) => {\n    const x = e.clientX / window.innerWidth;\n    const y = e.clientY / window.innerHeight;\n    const xOffset = -(x * 20);\n    const yOffset = -(y * 20);\n\n    const login = document.querySelector(\".login\");\n    login.style.backgroundPosition = `calc(50% + ${xOffset}px) calc(50% + ${yOffset}px)`;\n  };\n  document.addEventListener(\"mousemove\", bgMoveHandler);\n});\n\nonUnmounted(() => {\n  document.removeEventListener(\"mousemove\", bgMoveHandler);\n    \n});\n</script>\n\n<style lang=\"less\" scoped>\n@-webkit-keyframes fadenum {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n\n.login {\n  height: 100%;\n  height: 100%;\n  //图片\n\n  background-image: url(\"../../public/png.jpeg\");\n  background-repeat: no-repeat;\n  background-size: calc(100% + 40px) calc(100% + 40px);\n\n  background-position: 50% 50%;\n  background-attachment: fixed;\n\n  .el-icon {\n    height: 30px !important;\n  }\n\n  .login_container {\n    animation: fadenum 1s ease;\n    position: absolute;\n    z-index: 1;\n    width: 400px;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    transition: all 1s;\n    min-height: 273px;\n    text-align: center;\n    background-color: #fff;\n    border-radius: 10px;\n    padding: 20px;\n\n    h1 {\n      font-size: 24px;\n      transition: all 1s;\n      font-weight: bold;\n      margin-bottom: 36px;\n    }\n\n    .el-card {\n      border-radius: 20px;\n    }\n\n    .login_form {\n      .login_submit {\n        width: 100%;\n        height: 50px;\n        border-radius: 20px;\n        margin-bottom: 10px;\n        margin-top: 5px;\n      }\n\n      .login_register {\n        width: 6.25rem;\n        font-size: 0.875rem;\n        margin: 0 auto;\n      }\n      .test{\n        // 字体变小\n        font-size: 0.575rem;\n        // 字体颜色\n        color: #999;\n        margin-top: 10px;\n\n      }\n\n      :deep(.el-input-group__prepend) {\n        padding: 0 10px;\n      }\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}