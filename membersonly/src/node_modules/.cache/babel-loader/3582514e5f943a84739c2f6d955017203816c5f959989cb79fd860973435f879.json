{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-4b030cfa\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"login\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"bgp\"\n}, null, -1));\nconst _hoisted_3 = {\n  class: \"login_container\"\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"MemberOnly\", -1));\nimport store from '../store/index';\nimport http from '@/utils/request';\nimport router from \"../router/index\";\nimport axios from 'axios';\nimport { reactive, ref } from \"vue\";\nimport { onMounted, onUnmounted } from \"vue\";\nexport default {\n  __name: 'Login',\n  setup(__props) {\n    const openPdf = () => {\n      const pdfPath = process.env.BASE_URL + 'applicationform.pdf';\n      window.open(pdfPath, '_blank');\n    };\n\n    // 初始的ref\n    const ref_form = ref(null);\n    // 表单的数据声明\n    const userInfo = reactive({\n      userName: \"\",\n      password: \"\"\n    });\n\n    // 表单数据校验规则\n    const rules = {\n      userName: [{\n        required: \"true\",\n        trigger: \"blur\",\n        message: \"Please input user name\"\n      }],\n      password: [{\n        required: \"true\",\n        trigger: \"blur\",\n        message: \"Please input password\"\n      }]\n    };\n    // 登录的方法\n\n    const onLogin = () => {\n      ref_form.value.validate(val => {\n        if (val) {\n          getLoginData();\n        }\n      });\n    };\n    // 获取登录数据\n    const getLoginData = async () => {\n      const {\n        data: {\n          status,\n          msg,\n          token,\n          userInfo: myuserInfo\n        }\n      } = await http.post('/api/login', {\n        username: userInfo.userName,\n        password: userInfo.password\n      });\n      if (status === 1) {\n        ElMessage({\n          message: `${msg}`,\n          type: \"error\"\n        });\n        return;\n      }\n      if (status === 0) {\n        ElMessage({\n          message: \"Welcome back, \" + userInfo.userName,\n          type: \"success\"\n        });\n        // localStorage.setItem('userId',myuserInfo.id);  \n        store.dispatch({\n          type: 'getUserInfo',\n          payload: myuserInfo.id\n        });\n        localStorage.setItem('@#@TOKEN', token);\n        router.push(\"/home\");\n      }\n    };\n    let bgMoveHandler;\n    onMounted(() => {\n      bgMoveHandler = e => {\n        const x = e.clientX / window.innerWidth;\n        const y = e.clientY / window.innerHeight;\n        const xOffset = -(x * 20);\n        const yOffset = -(y * 20);\n        const login = document.querySelector(\".login\");\n        login.style.backgroundPosition = `calc(50% + ${xOffset}px) calc(50% + ${yOffset}px)`;\n      };\n      document.addEventListener(\"mousemove\", bgMoveHandler);\n    });\n    onUnmounted(() => {\n      document.removeEventListener(\"mousemove\", bgMoveHandler);\n    });\n    return (_ctx, _cache) => {\n      const _component_avatar = _resolveComponent(\"avatar\");\n      const _component_el_icon = _resolveComponent(\"el-icon\");\n      const _component_el_input = _resolveComponent(\"el-input\");\n      const _component_el_form_item = _resolveComponent(\"el-form-item\");\n      const _component_key = _resolveComponent(\"key\");\n      const _component_el_button = _resolveComponent(\"el-button\");\n      const _component_el_form = _resolveComponent(\"el-form\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createVNode(_component_el_form, {\n        class: \"login_form\",\n        model: userInfo,\n        rules: rules,\n        onKeyup: _withKeys(onLogin, [\"enter\"]),\n        ref_key: \"ref_form\",\n        ref: ref_form\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_form_item, {\n          prop: \"userName\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            placeholder: \"username\",\n            modelValue: userInfo.userName,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => userInfo.userName = $event),\n            modelModifiers: {\n              trim: true\n            }\n          }, {\n            prepend: _withCtx(() => [_createVNode(_component_el_icon, null, {\n              default: _withCtx(() => [_createVNode(_component_avatar)]),\n              _: 1\n            })]),\n            _: 1\n          }, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          prop: \"password\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            placeholder: \"passowrd\",\n            \"show-password\": \"\",\n            modelValue: userInfo.password,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => userInfo.password = $event),\n            modelModifiers: {\n              trim: true\n            }\n          }, {\n            prepend: _withCtx(() => [_createVNode(_component_el_icon, null, {\n              default: _withCtx(() => [_createVNode(_component_key)]),\n              _: 1\n            })]),\n            _: 1\n          }, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_button, {\n          type: \"primary\",\n          class: \"login_submit\",\n          onClick: onLogin\n        }, {\n          default: _withCtx(() => [_createTextVNode(\"Login\")]),\n          _: 1\n        }), _createElementVNode(\"div\", {\n          class: \"login_register\",\n          onClick: openPdf\n        }, \"Register form\")]),\n        _: 1\n      }, 8, [\"model\", \"onKeyup\"])])]);\n    };\n  }\n};","map":{"version":3,"names":["store","http","router","axios","reactive","ref","onMounted","onUnmounted","openPdf","pdfPath","process","env","BASE_URL","window","open","ref_form","userInfo","userName","password","rules","required","trigger","message","onLogin","value","validate","val","getLoginData","data","status","msg","token","myuserInfo","post","username","ElMessage","type","dispatch","payload","id","localStorage","setItem","push","bgMoveHandler","e","x","clientX","innerWidth","y","clientY","innerHeight","xOffset","yOffset","login","document","querySelector","style","backgroundPosition","addEventListener","removeEventListener"],"sources":["/Users/wucongzhen/Documents/GitHub/Akarana/src/src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login\">\n    <div class=\"bgp\"></div>\n    <div class=\"login_container\">\n      <h1>MemberOnly</h1>\n      <el-form class=\"login_form\" :model=\"userInfo\" :rules=\"rules\" @keyup.enter=\"onLogin\" ref=\"ref_form\">\n        <el-form-item prop=\"userName\">\n          <el-input placeholder=\"username\" v-model.trim=\"userInfo.userName\">\n            <template #prepend>\n              <el-icon>\n                <avatar />\n              </el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n\n        <el-form-item prop=\"password\">\n          <el-input placeholder=\"passowrd\" show-password v-model.trim=\"userInfo.password\">\n            <template #prepend>\n              <el-icon>\n                <key />\n              </el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n        <el-button type=\"primary\" class=\"login_submit\" @click=\"onLogin\">Login</el-button>\n        <div class=\"login_register\" @click=\"openPdf\">Register form</div>\n        <!-- <div class=\"test\"></div> -->\n      </el-form>\n    </div>\n  </div>\n</template>\n\n\n<script setup>\nimport store from '../store/index'\nimport http from '@/utils/request'\nimport router from \"../router/index\";\nimport axios from 'axios'\nimport { reactive, ref } from \"vue\";\nimport { onMounted, onUnmounted } from \"vue\";\nconst openPdf = () => {\n  const pdfPath = process.env.BASE_URL + 'applicationform.pdf';\n  window.open(pdfPath, '_blank');\n};\n\n\n// 初始的ref\nconst ref_form = ref(null);\n// 表单的数据声明\nconst userInfo = reactive({\n  userName: \"\",\n  password: \"\",\n});\n\n// 表单数据校验规则\nconst rules = {\n  userName: [\n    { required: \"true\", trigger: \"blur\", message: \"Please input user name\" },\n  ],\n  password: [\n    { required: \"true\", trigger: \"blur\", message: \"Please input password\" },\n  ],\n};\n// 登录的方法\n\nconst onLogin = () => {\n  ref_form.value.validate((val) => {\n    if (val) {\n      getLoginData();\n    }\n  });\n};\n// 获取登录数据\nconst getLoginData = async () => {\n\n  const { data: { status, msg, token ,userInfo:myuserInfo} } = await http.post('/api/login', {\n    username: userInfo.userName,\n    password: userInfo.password\n  });\n\n  if (status === 1) {\n    ElMessage({\n      message: `${msg}`,\n      type: \"error\",\n    });\n    return;\n  }\n\n  if (status === 0) {\n    ElMessage({\n      message: \"Welcome back, \" + userInfo.userName,\n     \n      type: \"success\",\n    });\n    // localStorage.setItem('userId',myuserInfo.id);  \n    store.dispatch({\n      type:'getUserInfo',\n      payload:myuserInfo.id\n    })\n    localStorage.setItem('@#@TOKEN', token)\n    router.push(\"/home\");\n  }\n\n};\n\nlet bgMoveHandler;\n\nonMounted(() => {\n  bgMoveHandler = (e) => {\n    const x = e.clientX / window.innerWidth;\n    const y = e.clientY / window.innerHeight;\n    const xOffset = -(x * 20);\n    const yOffset = -(y * 20);\n\n    const login = document.querySelector(\".login\");\n    login.style.backgroundPosition = `calc(50% + ${xOffset}px) calc(50% + ${yOffset}px)`;\n  };\n  document.addEventListener(\"mousemove\", bgMoveHandler);\n});\n\nonUnmounted(() => {\n  document.removeEventListener(\"mousemove\", bgMoveHandler);\n});\n\n</script>\n\n<style lang=\"less\" scoped>\n@-webkit-keyframes fadenum {\n  0% {\n    opacity: 0;\n  }\n\n  100% {\n    opacity: 1;\n  }\n}\n\n.login {\n  height: 100%;\n  height: 100%;\n  //图片\n\n  background-image: url(\"../../public/png.jpeg\");\n  background-repeat: no-repeat;\n  background-size: calc(100% + 40px) calc(100% + 40px);\n\n  background-position: 50% 50%;\n  background-attachment: fixed;\n\n  .el-icon {\n    height: 30px !important;\n  }\n\n  .login_container {\n    animation: fadenum 1s ease;\n    position: absolute;\n    z-index: 1;\n    width: 400px;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    transition: all 1s;\n    min-height: 273px;\n    text-align: center;\n    background-color: #fff;\n    border-radius: 10px;\n    padding: 20px;\n\n    h1 {\n      font-size: 24px;\n      transition: all 1s;\n      font-weight: bold;\n      margin-bottom: 36px;\n    }\n\n    .el-card {\n      border-radius: 20px;\n    }\n\n    .login_form {\n      .login_submit {\n        width: 100%;\n        height: 50px;\n        border-radius: 20px;\n        margin-bottom: 10px;\n        margin-top: 5px;\n      }\n\n      .login_register {\n        width: 6.25rem;\n        font-size: 0.875rem;\n        margin: 0 auto;\n      }\n      .test{\n        // 字体变小\n        font-size: 0.575rem;\n        // 字体颜色\n        color: #999;\n        margin-top: 10px;\n\n      }\n\n      :deep(.el-input-group__prepend) {\n        padding: 0 10px;\n      }\n    }\n  }\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}