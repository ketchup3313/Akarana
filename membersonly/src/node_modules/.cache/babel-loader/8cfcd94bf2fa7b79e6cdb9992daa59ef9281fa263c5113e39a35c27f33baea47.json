{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-e8ec187c\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  class: \"header_my\"\n};\nconst _hoisted_4 = {\n  class: \"content clearfix\"\n};\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  class: \"section_join\"\n};\nconst _hoisted_7 = {\n  key: 0\n};\nconst _hoisted_8 = {\n  key: 1\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = {\n  class: \"small\"\n};\nconst _hoisted_11 = {\n  class: \"small_item\"\n};\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  class: \"bulletintext\"\n}, \" Time \", -1));\nconst _hoisted_13 = {\n  class: \"small_item\"\n};\nconst _hoisted_14 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  class: \"bulletintext\"\n}, \" Address \", -1));\nconst _hoisted_15 = [\"innerHTML\"];\nconst _hoisted_16 = {\n  class: \"participants-section\"\n};\nconst _hoisted_17 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"Who want to join:\", -1));\nconst _hoisted_18 = {\n  key: 0\n};\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  class: \"bulletintext\"\n}, \"Bulletin:\", -1));\nconst _hoisted_20 = {\n  class: \"download-pdf-button\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Header = _resolveComponent(\"Header\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_Header, {\n    handleCollapse: _ctx.handleCollapse,\n    isCollapse: _ctx.isCollapse\n  }, null, 8, [\"handleCollapse\", \"isCollapse\"]), _createElementVNode(\"div\", _hoisted_1, [JSON.stringify($data.details) !== '{}' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"header\", _hoisted_3, [_createElementVNode(\"h2\", null, _toDisplayString($data.details.mainTitle), 1), _createElementVNode(\"p\", _hoisted_4, [_createElementVNode(\"img\", {\n    align: \"right\",\n    style: {\n      \"min-width\": \"500px\",\n      \"max-width\": \"500px\"\n    },\n    height: \"340\",\n    src: $data.details.image,\n    alt: \"img\",\n    class: \"img\"\n  }, null, 8, _hoisted_5), _createTextVNode(\" \" + _toDisplayString($data.details.content), 1)])]), _createElementVNode(\"section\", _hoisted_6, [$data.details.status === 'open' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_7, \"Group is open\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_8, \"Group is close\")), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = $event => $options.requestJoin($data.details.id)),\n    class: _normalizeClass([\"btn\", {\n      'btn-disabled': $data.details.status === 'close'\n    }]),\n    disabled: $data.details.status === 'close'\n  }, _toDisplayString($data.details.status === 'open' ? 'Request to join' : 'This activity is closed'), 11, _hoisted_9)]), _createElementVNode(\"section\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_hoisted_12, _createElementVNode(\"p\", null, _toDisplayString($data.details.time), 1)]), _createElementVNode(\"div\", _hoisted_13, [_hoisted_14, _createElementVNode(\"p\", null, [_createTextVNode(_toDisplayString($data.details.address) + \" \", 1), _createElementVNode(\"div\", {\n    innerHTML: $data.details.mapUrl\n  }, null, 8, _hoisted_15)]), _createElementVNode(\"div\", _hoisted_16, [_hoisted_17, _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.participants, (participant, index) => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: index\n    }, _toDisplayString(participant.username), 1);\n  }), 128))]), $data.participants.length === 0 ? (_openBlock(), _createElementBlock(\"p\", _hoisted_18, \" There are no participants for this rally yet. \")) : _createCommentVNode(\"\", true), _hoisted_19, _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.previewPdf && $options.previewPdf(...args)),\n    class: \"btn download-pdf-btn\"\n  }, \"Download PDF\")])])])])])) : _createCommentVNode(\"\", true)])]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_Header","handleCollapse","_ctx","isCollapse","_hoisted_1","JSON","stringify","$data","details","_hoisted_2","_hoisted_3","_toDisplayString","mainTitle","_hoisted_4","align","style","height","src","image","alt","content","_hoisted_6","status","_hoisted_7","_hoisted_8","onClick","_cache","$event","$options","requestJoin","id","_normalizeClass","disabled","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","time","_hoisted_13","_hoisted_14","address","innerHTML","mapUrl","_hoisted_16","_hoisted_17","_Fragment","_renderList","participants","participant","index","key","username","length","_hoisted_18","_hoisted_19","_hoisted_20","args","previewPdf"],"sources":["/Users/wucongzhen/Documents/GitHub/Akarana/src/src/views/RallyDetails.vue"],"sourcesContent":["<template>\n    <div>\n      <Header :handleCollapse=\"handleCollapse\" :isCollapse=\"isCollapse\" />\n      <div  class=\"container\">\n        <div v-if=\"JSON.stringify(details) !== '{}'\">\n          <header class=\"header_my\">\n            <h2>{{ details.mainTitle }}</h2>\n            <!-- <h4>{{details.subTitle}}</h4> -->\n            <p class=\"content clearfix\">\n              <img align=\"right\" style=\"min-width: 500px; max-width:500px;\" height=\"340\" :src=\"details.image\" alt=\"img\"\n                class=\"img\">\n  \n              {{ details.content }}\n            </p>\n  \n          </header>\n          <section class=\"section_join\">\n            <span v-if=\"details.status === 'open'\">Group is open</span>\n            <span v-else>Group is close</span>\n            <!-- <button @click=\"requestJoin(details.id)\" class=\"btn\">Request to join</button> -->\n            <!-- <button @click=\"requestJoin(details.id)\" class=\"btn\" :disabled=\"details.status === 'close'\">Request to\n              join</button> -->\n            <button @click=\"requestJoin(details.id)\" class=\"btn\" :class=\"{ 'btn-disabled': details.status === 'close' }\"\n              :disabled=\"details.status === 'close'\">\n              {{ details.status === 'open' ? 'Request to join' : 'This activity is closed' }}\n            </button>\n          </section>\n          <section class=\"small\">\n            <div class=\"small_item\">\n              <h3 class=\"bulletintext\">\n                Time\n              </h3>\n              <p>\n                {{ details.time }}\n              </p>\n            </div>\n            <div class=\"small_item\">\n              <h3 class=\"bulletintext\">\n                Address\n              </h3>\n              <p>\n                {{ details.address }}\n\n              \n                <div v-html=\"details.mapUrl\"></div>\n              </p>\n              <div class=\"participants-section\">\n    <h3>Who want to join:</h3>\n    <ul>\n      <li v-for=\"(participant, index) in participants\" :key=\"index\">\n        {{ participant.username }}\n      </li>\n    </ul>\n    <p v-if=\"participants.length === 0\">\n      There are no participants for this rally yet.\n    </p>\n    <h3 class=\"bulletintext\">Bulletin:</h3>\n   \n                <div class=\"download-pdf-button\" >\n  <button @click=\"previewPdf\" class=\"btn download-pdf-btn\">Download PDF</button>\n</div>\n    \n  </div>\n  <!-- 改成英文的，增加谁参加了这个活动， -->\n              \n            </div>\n          </section>\n        </div>\n       \n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import http from '@/utils/request'\n  import { ElLoading } from 'element-plus';\n\n  export default {\n    \n    data() {\n      return {\n        details: {},\n        participants: [],\n        bulletin: [],\n        urlWithTimestamp:[]\n      }\n    },\n    methods: {\n      previewPdf() {\n    if (this.details.bulletin) {\n      const timestamp = new Date().getTime();\n    const urlWithTimestamp = `${this.details.bulletin}?t=${timestamp}`;\n    console.log(urlWithTimestamp);\n      window.open(urlWithTimestamp);\n    } else {\n      ElMessage({\n        message: \"No PDF available.\",\n        type: \"warning\",\n      });\n    }\n  },\n      async requestJoin(rallyid) {\n        let res = await http.post('/api/rally/requestJoin', {\n          userid: this.$store.state.userInfo.id,\n          username: this.$store.state.userInfo.username,\n          rallyid,\n        })\n        let { msg, status } = res.data;\n  \n        if (status === 1) {\n          ElMessage({\n            message: msg,\n            type: \"error\",\n          });\n        } else {\n          ElMessage({\n            message: msg,\n            type: \"success\",\n          });\n        }\n      },\n    },\n \n    async created() {\n    let { id } = this.$route.query;\n    const loadingInstance = ElLoading.service({\n      lock: true,\n      text: \"Loading\",\n      background: \"rgba(0, 0, 0, 0.7)\",\n    });\n\n    try {\n      const [participantsRes, detailsRes] = await Promise.all([\n        http.get(`/api/rally/queryParticipants?rallyid=${id}`),\n        http.get(`/api/rally/queryInfo?id=${id}`),\n      ]);\n\n      // Handle participantsRes\n      let { data: participantsData, status: participantsStatus } = participantsRes.data;\n      if (participantsStatus === 0) {\n        this.participants = participantsData;\n      }\n\n      // Handle detailsRes\n      let { data: detailsData, status: detailsStatus } = detailsRes.data;\n      if (detailsStatus === 0) {\n        this.details = detailsData;\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      loadingInstance.close(); //close draw\n    }\n  },\n\n\n\n  }\n  </script>\n  \n  <style  scoped>\n  * {\n    margin: 0;\n    padding: 0;\n  }\n  \n  .clearfix:after {\n    content: \"\";\n    display: block;\n    height: 0;\n    clear: both;\n  }\n  \n  .small_item p {\n    margin: 16px 0px;\n    letter-spacing: 2px;\n    color: #747474;\n  }\n  \n  .p {\n    color: #6c6b6b;\n  }\n  \n  .btn {\n    cursor: pointer;\n    color: #FFFFFF;\n    padding: 10px 20px;\n    letter-spacing: 2px;\n    border-radius: 30px;\n    background-image: linear-gradient(90deg, rgb(149, 223, 236), rgb(138, 226, 138));\n  }\n  \n  .btn-disabled {\n    background-color: #ccc;\n    color: #999;\n    background-image: none;\n  }\n  \n  .section_join {\n    margin: 20px 0px;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    border-radius: 6px;\n    padding: 20px 30px;\n    background-color: #fafafa;\n  }\n  \n  .content {\n    letter-spacing: 1px;\n    line-height: 40px;\n  }\n  \n  .header_my {\n    /* display: flex; */\n  }\n  \n  .img {\n    border-radius: 10px;\n    object-fit: cover;\n  }\n  \n  .container {\n    padding: 20px 20%;\n  }\n  .bulletintext{\n    margin-top: 30px;\n  }\n  </style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}